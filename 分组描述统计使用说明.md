# 📊 分组描述统计功能使用说明

## ✅ 功能已添加

已成功在 AIStats 项目中添加"分组描述统计"功能！

---

## 🎯 功能说明

**分组描述统计**可以按照某个分类变量（如年级、性别、学校等）对数据进行分组，然后分别计算每组的描述统计量（均值、标准差等）。

这正是你图片中表格的生成方式！

---

## 📖 使用步骤

### **步骤1：启动应用**
```bash
启动应用.bat
```

### **步骤2：导入数据**
1. 进入 **📁 数据视图**
2. 上传 `666.xlsx` 文件
3. 确认数据导入成功（1175行 × 20列）

### **步骤3：进入统计视图**
1. 点击 **📊 统计视图**
2. 在"选择统计方法"下拉菜单中选择 **"📊 分组描述统计"**

### **步骤4：配置分析参数**

#### **选择分组变量**
- 选择：`class`（年级）
- 说明：按此变量分组计算统计量

#### **选择要分析的变量**
根据你的需求选择：

**方式A：分别统计每个题目**
- 选择：`1.1, 1.2, 1.3, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 5.1, 5.2`
- 结果：每个题目都会显示均值和标准差

**方式B：计算维度得分（推荐，与你的图片一致）**
1. 展开 **"🔧 高级选项：维度得分计算"**
2. 勾选 **"计算维度得分"**
3. 分5次运行，每次选择一个维度的题目：
   - 维度1：选择 `1.1, 1.2, 1.3`
   - 维度2：选择 `2.1, 2.2`
   - 维度3：选择 `3.1, 3.2, 3.3`
   - 维度4：选择 `4.1, 4.2`
   - 维度5：选择 `5.1, 5.2`

### **步骤5：查看结果**
点击 **"计算分组统计"** 按钮，系统会显示：
- 分组统计表格
- 每组的样本量
- 每个变量（或维度）的均值和标准差

### **步骤6：导出结果**
结果表格下方有两个下载按钮：
- **📥 下载 CSV**：导出为 CSV 格式
- **📥 下载 Excel**：导出为 Excel 格式

---

## 💡 两种模式对比

### **模式1：普通模式（不勾选维度得分）**

**输入：**
- 分组变量：`class`
- 分析变量：`1.1, 1.2, 1.3`

**输出表格：**
| class | 样本量 | 1.1_均值 | 1.1_标准差 | 1.2_均值 | 1.2_标准差 | 1.3_均值 | 1.3_标准差 |
|-------|--------|----------|------------|----------|------------|----------|------------|
| 6     | 160    | 3.4      | 1.0        | 3.5      | 0.9        | 3.3      | 1.1        |
| 7     | 246    | 3.6      | 0.9        | 3.7      | 0.8        | 3.5      | 1.0        |
| ...   | ...    | ...      | ...        | ...      | ...        | ...      | ...        |

---

### **模式2：维度得分模式（勾选维度得分）✅ 推荐**

**输入：**
- 分组变量：`class`
- 分析变量：`1.1, 1.2, 1.3`
- ✅ 勾选"计算维度得分"

**输出表格：**
| class | 样本量 | 均值 | 标准差 | 最小值 | 最大值 |
|-------|--------|------|--------|--------|--------|
| 6     | 160    | 3.4  | 0.8    | 1.0    | 5.0    |
| 7     | 246    | 3.6  | 0.9    | 1.3    | 5.0    |
| 8     | 217    | 3.3  | 0.8    | 1.0    | 5.0    |
| 9     | 287    | 3.6  | 0.9    | 1.0    | 5.0    |
| 10    | 158    | 3.6  | 0.8    | 1.3    | 5.0    |
| 11    | 107    | 3.6  | 0.8    | 1.7    | 5.0    |

**说明：**
- 先计算每个学生在 1.1, 1.2, 1.3 三个题目的平均分（维度得分）
- 然后按年级分组，计算每组学生的维度得分的均值和标准差
- **这正是你图片中的计算方式！**

---

## 🎨 生成你图片中的完整表格

要生成和你图片完全一样的表格，需要运行5次分析：

### **第1次：维度1**
- 分组变量：`class`
- 分析变量：`1.1, 1.2, 1.3`
- ✅ 勾选"计算维度得分"
- 点击"计算分组统计"
- 下载结果为 `维度1.xlsx`

### **第2次：维度2**
- 分组变量：`class`
- 分析变量：`2.1, 2.2`
- ✅ 勾选"计算维度得分"
- 点击"计算分组统计"
- 下载结果为 `维度2.xlsx`

### **第3次：维度3**
- 分组变量：`class`
- 分析变量：`3.1, 3.2, 3.3`
- ✅ 勾选"计算维度得分"
- 点击"计算分组统计"
- 下载结果为 `维度3.xlsx`

### **第4次：维度4**
- 分组变量：`class`
- 分析变量：`4.1, 4.2`
- ✅ 勾选"计算维度得分"
- 点击"计算分组统计"
- 下载结果为 `维度4.xlsx`

### **第5次：维度5**
- 分组变量：`class`
- 分析变量：`5.1, 5.2`
- ✅ 勾选"计算维度得分"
- 点击"计算分组统计"
- 下载结果为 `维度5.xlsx`

### **最后：合并表格**
在 Excel 中将5个文件的"均值"和"标准差"列合并到一个表格中，就得到了你图片中的完整表格！

---

## 🔧 其他用途

这个功能不仅可以用于问卷分析，还可以用于：

1. **按年级比较成绩**
   - 分组变量：`class`
   - 分析变量：`ch1, ch2, ch3, ch4, ch5`

2. **按学校比较表现**
   - 分组变量：`school`
   - 分析变量：任意变量

3. **按性别比较差异**
   - 分组变量：性别变量
   - 分析变量：任意变量

---

## ⚠️ 注意事项

1. **分组变量**必须至少有2个不同的值
2. **分析变量**必须是数值型变量
3. 如果数据中有缺失值，会自动忽略
4. 维度得分模式下，会先计算每个样本的平均分，再按组统计

---

## 🎉 完成！

现在你可以直接在 AIStats 界面中生成分组描述统计表了，不需要写任何代码！

如有问题，请查看应用中的提示信息或联系开发者。
