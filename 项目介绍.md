# AIStats - AI 驱动的在线统计分析平台

<div align="center">

![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![Python](https://img.shields.io/badge/python-3.8+-green.svg)
![License](https://img.shields.io/badge/license-MIT-orange.svg)

**一个现代化、智能化的在线统计分析工具**

[快速开始](#快速开始) • [功能特性](#核心功能) • [使用文档](#使用指南) • [技术架构](#技术架构)

</div>

---

## 📋 项目概述

AIStats（AI Statistical Package for Social Sciences）是一个基于 Python 和 Streamlit 构建的现代化在线统计分析平台。项目受 PsychPen 启发，旨在为研究人员、数据分析师和学生提供一个易用、强大且智能的统计分析工具。

### 🎯 项目特色

- **🤖 AI 智能助手**：集成大语言模型，通过自然语言交互进行数据分析
- **📊 专业统计分析**：涵盖描述统计、假设检验、方差分析、回归分析等常用方法
- **📈 交互式可视化**：基于 Plotly 的动态图表，支持多种图表类型
- **🎨 现代化界面**：简洁直观的 Web 界面，无需编程即可完成复杂分析
- **💾 多格式支持**：支持 CSV、Excel 等常见数据格式
- **🔒 本地化处理**：所有数据处理均在本地完成，保护数据隐私

---

## 🚀 核心功能

### 1️⃣ 数据视图模块

**数据导入与管理**
- ✅ 支持多种格式：CSV、Excel (.xlsx/.xls)
- ✅ 实时数据预览与基本信息展示
- ✅ 内存占用监控
- ✅ 多格式导出功能
- ✅ 一键查看描述统计
- ✅ 安全的数据删除机制

**核心特性**：
```python
# 数据基本信息展示
- 总行数、总列数
- 数据集名称
- 内存占用情况
```

---

### 2️⃣ 绘图视图模块

**7 种专业图表类型**

| 图表类型 | 功能特性 | 适用场景 |
|---------|---------|---------|
| **📉 折线图** | 多变量、数据点标记、样条曲线 | 时间序列、趋势分析 |
| **🔵 散点图** | 分组着色、大小映射、趋势线 | 相关关系、分布探索 |
| **📊 柱状图** | 分组、多种聚合函数 | 分类比较、频数统计 |
| **📦 箱线图** | 多变量、分组对比 | 分布比较、异常值检测 |
| **🥧 饼图** | 百分比标签、数据标注 | 组成比例分析 |
| **📊 直方图** | 可调分组数、分布展示 | 数据分布、正态性检验 |
| **🌐 3D散点图** | 三维可视化、交互旋转 | 多维数据探索 |

**高级功能**：
- 🎨 自动颜色分组
- 📐 回归方程显示（散点图）
- 🔄 交互式图表（缩放、平移、悬停提示）
- 💾 一键导出图表为图片

---

### 3️⃣ 统计视图模块

**完整的统计分析工具箱**

#### 📋 描述统计
- 均值、标准差、最小值、最大值
- 四分位数（Q1、中位数、Q3）
- 偏度、峰度
- 缺失值统计

#### 🔬 假设检验

**t 检验系列**
- ✅ 单样本 t 检验：检验样本均值是否等于某个值
- ✅ 配对样本 t 检验：检验两个相关样本的均值差异
- ✅ 独立样本 t 检验：比较两个独立组的均值

**方差分析**
- ✅ 单因素 ANOVA：比较多组均值
- ✅ Levene 方差齐性检验
- ✅ 显著性标注（*p<0.05, **p<0.01, ***p<0.001）

#### 🔗 相关与回归

**相关分析**
- ✅ Pearson 相关系数矩阵
- ✅ 相关显著性检验（p 值矩阵）
- ✅ 热力图可视化

**回归分析**
- ✅ 一元线性回归
  - 回归方程
  - R²、调整 R²
  - 系数显著性检验
- ✅ 多元线性回归
  - 完整回归摘要
  - 多重共线性诊断（VIF）
  - 残差分析

#### 🎯 高级分析

**信度分析**
- ✅ Cronbach's Alpha 系数
- ✅ 自动信度等级评估
  - α ≥ 0.9：优秀
  - α ≥ 0.8：良好
  - α ≥ 0.7：可接受

**中介效应分析**
- ✅ 简单中介模型（X → M → Y）
- ✅ 路径系数计算（a、b、c、c'）
- ✅ 间接效应与直接效应
- ✅ 中介比例计算

---

### 4️⃣ AI 辅助分析模块

**智能对话式数据分析**

#### 🤖 AI 功能特性

- **自然语言交互**：用简单的中文提问，AI 自动理解并分析
- **上下文感知**：AI 了解当前数据集的所有信息
- **自动工具调用**：无需手动操作，AI 自动获取数据统计
- **专业解读**：提供统计结果的专业解释和建议

#### 💬 使用示例

```
用户：当前数据集有多少行？各变量的类型是什么？
AI：✓ 自动获取数据信息并回答

用户：帮我看看变量 age 和 income 的描述统计
AI：✓ 调用描述统计函数，展示均值、标准差等

用户：解释一下最新的 t 检验结果
AI：✓ 读取统计结果，提供专业解读和建议
```

#### ⚙️ 支持的 AI 服务

| 服务商 | 推荐度 | 特点 |
|-------|-------|------|
| **DeepSeek** | ⭐⭐⭐⭐⭐ | 性价比高、中文友好、支持 Function Calling |


---

## 🛠️ 技术架构

### 核心技术栈

```
┌──────────────────────────────────────────────────────────────┐
│                   Web 应用层 (Streamlit)                       │
├──────────────────────────────────────────────────────────────┤
│  数据视图 │ 值标签 │ AI视图 │ 绘图视图 │ 统计视图 │ 术语解释 │ 新手指南 │
├──────────────────────────────────────────────────────────────┤
│              数据处理层 (pandas, numpy)                        │
│            统计计算层 (scipy, statsmodels)                     │
│                可视化层 (plotly)                               │
│              AI 交互层 (openai)                                │
├──────────────────────────────────────────────────────────────┤
│                   数据存储 (session_state)                     │
└──────────────────────────────────────────────────────────────┘
```

### 技术选型理由

| 技术 | 版本 | 选型理由 |
|------|------|---------|
| **Streamlit** | ≥1.28.0 | 快速构建数据应用，无需前端开发 |
| **pandas** | ≥2.2.0 | 强大的数据处理能力 |
| **Plotly** | ≥5.20.0 | 交互式图表，支持导出 |
| **SciPy** | ≥1.12.0 | 科学计算与统计检验 |
| **Statsmodels** | ≥0.14.0 | 专业统计模型 |
| **OpenAI** | ≥1.12.0 | 统一的 LLM API 接口 |

### 项目结构

```
AIStats/
├── app.py                      # 应用入口，路由配置
├── requirements.txt            # 依赖管理
├── README.md                   # 英文文档
├── 项目介绍.md                  # 中文详细介绍
└── src/
    ├── __init__.py
    ├── components/             # 功能模块
    │   ├── __init__.py
    │   ├── data_view.py       # 数据导入/预览/导出
    │   ├── plot_view.py       # 7种图表绘制
    │   ├── stat_view.py       # 9种统计方法
    │   └── ai_view_v2.py      # AI 对话（支持 Function Calling）
    └── lib/                   # 工具函数库
        ├── __init__.py
        └── stat_functions.py  # 统计函数封装（供 AI 调用）
```

---

## 🚀 快速开始

### 环境要求

- Python 3.8 或更高版本
- pip 包管理器

### 安装步骤

#### 1. 克隆项目

```bash
git clone <your-repository-url>
cd AIStats
```

#### 2. 安装依赖

```bash
pip install -r requirements.txt
```

#### 3. 运行应用

```bash
streamlit run app.py
```

应用将自动在浏览器中打开，默认地址：`http://localhost:8501`

---

## 📖 使用指南

### 1. 数据导入

1. 点击侧边栏的 **"📁 数据视图"**
2. 点击 **"选择数据文件"** 按钮
3. 选择您的数据文件（CSV/Excel）
4. 查看数据预览和基本信息

**支持的数据格式**：
- CSV：标准逗号分隔文件
- Excel：.xlsx 和 .xls 格式

### 2. 数据可视化

1. 切换到 **"📈 绘图视图"**
2. 选择图表类型
3. 配置 X 轴、Y 轴、分组等参数
4. 点击 **"生成图表"** 按钮
5. 使用 Plotly 工具栏进行交互（缩放、保存等）

**示例：绘制散点图**
```
1. 选择"散点图"
2. X 轴：选择自变量
3. Y 轴：选择因变量
4. 颜色分组：选择分组变量（可选）
5. 勾选"显示趋势线"
6. 点击"生成散点图"
7. 查看回归方程和 R² 值
```

### 3. 统计分析

1. 切换到 **"📊 统计视图"**
2. 选择统计方法
3. 选择变量并配置参数
4. 点击 **"执行分析"** 按钮
5. 查看结果表格和统计摘要

**示例：独立样本 t 检验**
```
1. 选择"独立样本 t 检验"
2. 数据变量：选择连续变量（如"成绩"）
3. 分组变量：选择二分类变量（如"性别"）
4. 点击"执行检验"
5. 查看 t 值、p 值、Cohen's d 等结果
```

### 4. AI 辅助分析

#### 配置 AI 服务

1. 切换到 **"🤖 AI 辅助分析"**
2. 展开 **"⚙️ AI 配置"**
3. 填写配置信息：
   - **API Key**：从 AI 服务商获取
   - **Base URL**：API 端点地址
   - **模型名称**：如 `deepseek-chat`
4. 勾选 **"开启 AI 辅助分析"**
5. 点击 **"保存配置"**

#### DeepSeek 配置示例

```
API Key: sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Base URL: https://api.deepseek.com
模型名称: deepseek-chat
```

> 💡 **获取 DeepSeek API Key**：
> 1. 访问 https://platform.deepseek.com
> 2. 注册并登录
> 3. 在 API Keys 页面创建新密钥
> 4. 复制密钥到配置中

#### AI 对话示例

**基础查询**：
```
Q: 当前数据集有多少行？
A: ✓ AI 自动获取并回答

Q: 有哪些变量？
A: ✓ 列出所有变量及其类型
```

**统计查询**：
```
Q: 帮我看看变量 age 的均值和标准差
A: ✓ 调用描述统计，展示详细数据

Q: 变量 score 的分布是否正态？
A: ✓ 提供专业建议（可结合直方图判断）
```

**结果解读**：
```
Q: 刚才的 t 检验结果说明了什么？
A: ✓ 解读 p 值、效应量，给出结论和建议

Q: R² = 0.65 代表什么意思？
A: ✓ 解释决定系数，评估模型拟合优度
```

---

## 🎓 应用场景

### 学术研究
- 心理学实验数据分析
- 问卷调查数据处理
- 毕业论文统计分析

### 数据分析
- 业务数据探索性分析
- A/B 测试结果评估
- 用户行为数据分析

### 教学培训
- 统计学课程演示
- SPSS 替代方案
- 数据分析入门教学

---

## ⚠️ 注意事项

### 数据隐私
- ✅ 所有数据处理均在本地完成
- ⚠️ 使用 AI 功能时会将数据摘要发送到配置的 API 服务
- 💡 敏感数据请谨慎使用 AI 功能

### 统计假设
- **正态性**：t 检验、ANOVA 等方法假设数据正态分布
- **方差齐性**：独立样本 t 检验假设方差相等
- **独立性**：观测值之间应相互独立
- **线性关系**：回归分析假设变量间线性关系

> 💡 建议：使用前请通过直方图等检验假设条件

### API 成本
- DeepSeek：约 ¥0.001/千 tokens（非常便宜）
- GPT-4：约 $0.03/千 tokens
- 建议设置 API 使用限额

---

## 🔧 进阶功能

### 自定义统计函数

您可以在 `src/lib/stat_functions.py` 中添加自己的统计函数：

```python
def my_custom_test(var1: str, var2: str):
    """自定义统计检验"""
    df = st.session_state.data
    
    # 您的统计逻辑
    result = ...
    
    # 保存结果
    st.session_state.stat_result = result
    return result
```

### 扩展图表类型

在 `src/components/plot_view.py` 中添加新图表：

```python
elif plot_type == "我的图表":
    st.subheader("🎨 自定义图表")
    
    # 参数配置
    x_col = st.selectbox("X 轴", df.columns)
    
    if st.button("生成图表"):
        # 使用 Plotly 创建图表
        fig = px.xxx(...)
        st.plotly_chart(fig, use_container_width=True)
```

---

## 🐛 常见问题

### Q1: 导入数据失败？
**A**: 检查文件格式和编码
- CSV 文件建议使用 UTF-8 编码
- Excel 文件确保无合并单元格
- 文件路径不要包含特殊字符

### Q2: AI 调用失败？
**A**: 检查以下几点
1. API Key 是否正确
2. Base URL 是否可访问
3. 网络连接是否正常
4. API 余额是否充足

### Q3: 统计结果显示 NaN？
**A**: 可能原因
- 数据中存在缺失值
- 变量类型不匹配（如分类变量进行 t 检验）
- 样本量过小

### Q4: 图表无法显示？
**A**: 尝试以下操作
1. 刷新页面
2. 检查变量是否为数值型
3. 查看浏览器控制台是否有错误

---

## 🤝 贡献指南

欢迎贡献代码、报告 Bug 或提出新功能建议！

### 贡献步骤
1. Fork 本项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

### 开发规范
- 代码风格遵循 PEP 8
- 函数添加详细的文档字符串
- 新功能需添加使用示例
- 提交前运行测试

---

## 📝 更新日志

### v1.0.0 (2024-10-22)
- ✅ 初始版本发布
- ✅ 实现数据导入/导出/预览
- ✅ 实现 7 种图表类型
- ✅ 实现 9 种统计方法
- ✅ 集成 AI 辅助分析
- ✅ 支持 DeepSeek 等多种 AI 服务

---

## 📄 许可证

本项目采用 **MIT 许可证**，详见 [LICENSE](LICENSE) 文件。

您可以自由地：
- ✅ 商业使用
- ✅ 修改
- ✅ 分发
- ✅ 私人使用

---

## 🙏 致谢

- [PsychPen](https://github.com/LeafYeeXYZ/PsychPen) - 项目设计灵感来源
- [Streamlit](https://streamlit.io/) - 优秀的 Web 应用框架
- [Plotly](https://plotly.com/) - 强大的可视化库
- [SciPy](https://scipy.org/) - 科学计算工具
- [Statsmodels](https://www.statsmodels.org/) - 统计建模库
- [DeepSeek](https://www.deepseek.com/) - 高性价比 AI 服务

---

## 📞 联系方式

- 问题反馈：[GitHub Issues](https://github.com/yourusername/AIStats/issues)
- 功能建议：[GitHub Discussions](https://github.com/yourusername/AIStats/discussions)

---

<div align="center">

添加智能VLOOKUP函数，添加智能数据标签值功能，优化UI，添加自动生成图片跳转功能。

</div>

